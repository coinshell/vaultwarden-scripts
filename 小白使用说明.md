------------------------------------------------ 小白使用说明.md ------------------------------------------------
一、准备工作（一次性）
一台干净的 Linux 虚拟机/云服务器
推荐 Debian 11/12、Ubuntu 20/22、CentOS 7/8、Alma/Rocky 8/9，任意一家云厂商都行。
最低配置：1 vCPU + 1 GB 内存 + 10 GB 硬盘（能跑 Docker 即可）。
一个你自己的域名，例如 vault.abc.com
把域名解析到这台机器的公网 IP（A 记录）。
一个 Cloudflare R2 账号（免费 10 GB）
登录 https://dash.cloudflare.com → R2 → 创建存储桶 → 记下以下 4 个值：
桶名（Bucket）
S3 端点（Endpoint，类似 https://123abc.r2.cloudflarestorage.com）
Access Key ID
Secret Access Key
一个你的邮箱，用来申请免费 HTTPS 证书（Let's Encrypt）。
二、第一次安装（30 分钟）
步骤 1：登录服务器
用 Xshell、PuTTY、Termius、iTerm2 等工具，通过 root 用户 SSH 进机器。
步骤 2：一键下载脚本
bash
复制
# 国内机器可以用 gitee 镜像，下面用 GitHub 举例
curl -O https://raw.githubusercontent.com/yourname/yourrepo/main/install_vaultwarden.sh
curl -O https://raw.githubusercontent.com/yourname/yourrepo/main/restore_vaultwarden.sh
chmod +x install_vaultwarden.sh restore_vaultwarden.sh
步骤 3：把“必填参数”写进临时文件（最简单的方法）
用 nano 或 vim 新建一个文本，一次性把 6 个变量写进去，等会儿复制粘贴一次执行。
bash
复制
nano /tmp/myenv      # 输入内容如下，不要有空格
复制
export VW_DOMAIN=vault.abc.com
export ACME_EMAIL=你的邮箱@qq.com
export R2_BUCKET=你创建的桶名
export R2_ENDPOINT=https://123abc.r2.cloudflarestorage.com
export R2_ACCESS_KEY=你的AK
export R2_SECRET_KEY=你的SK
写完后
Ctrl + O 回车保存
Ctrl + X 退出
步骤 4：真正执行安装（一条命令）
bash
复制
source /tmp/myenv && ./install_vaultwarden.sh
看到 [OK] Vaultwarden 已运行在 https://vault.abc.com 就说明装好了！
浏览器直接访问 https://vault.abc.com，第一次打开先注册账号（管理员）。
全程不需要你手动装 Docker、Nginx、证书，脚本全搞定。
三、以后如何升级（1 条命令）
升级 = 重新跑一遍安装脚本，旧数据会自动备份并保留。
bash
复制
source /tmp/myenv && ./install_vaultwarden.sh
脚本会先：
把旧容器停掉
自动用 restic 备份一次数据库
拉取最新镜像（版本号在脚本里已经写死，作者会定期更新）
再重新启动
所以你只要下载新版 install_vaultwarden.sh，再执行上面同样命令即可，幂等安全。
四、备份是自动的，不用管
安装完成后，系统会自动添加一条定时任务：
每天凌晨 3 点整执行 /usr/local/bin/vw-backup，把加密数据库丢到你的 R2 仓库。
想手动备份也行：
bash
复制
vw-backup     # 回车即可
五、万一机器坏了 / 换机器，如何恢复（10 分钟）
在新机器同样用 root 登录
安装 curl、下载恢复脚本：
bash
复制
apt update && apt install -y curl   # Debian/Ubuntu 示例
curl -O https://raw.githubusercontent.com/yourname/yourrepo/main/restore_vaultwarden.sh
chmod +x restore_vaultwarden.sh
把“那 6 个变量”再写一次（也可以是新的域名/邮箱，只要 R2 不变）：
bash
复制
nano /tmp/myenv      # 跟上边完全一样，照抄
执行恢复：
bash
复制
source /tmp/myenv && ./restore_vaultwarden.sh
脚本会：
让你输入 RESTIC_PASSWORD（就是当初安装时自动生成的备份仓库密码，如果忘了，可在原机器 /srv/vaultwarden/.env 里 cat 查看）
自动下载最新快照 → 还原数据库 → 检查完整性 → 启动服务 → 健康探测
看到 [OK] Vaultwarden 已恢复并运行在 https://vault.abc.com 就完事了！
六、常见问题（FAQ）
表格
复制
问题	一句话解决
忘记 RESTIC_PASSWORD	在原机执行 `cat /srv/vaultwarden/.env	grep RESTIC_PASSWORD`
想改域名	改 VW_DOMAIN 变量 → 重新跑安装脚本
想改邮箱	改 ACME_EMAIL → 重新跑安装脚本
证书过期？	脚本内置自动续期，Caddy 会处理，不用管
想关闭公开注册？	把安装脚本里 SIGNUPS_ALLOWED=true 改成 false → 重新跑一遍
脚本运行一半断了？	重新跑，幂等，不会炸
七、目录/文件速查（了解即可）
表格
复制
路径	作用
/srv/vaultwarden/	所有数据都在这里
/srv/vaultwarden/vw-data/	数据库、附件
/srv/vaultwarden/.env	密钥/配置（内存级，不泄露）
/var/log/vaultwarden-install.log	安装日志
/var/log/vaultwarden-restore.log	恢复日志
/usr/local/bin/vw-backup	手动备份命令
/usr/local/bin/vw-status	查看容器状态
------------------------------------------------ 结束 ------------------------------------------------